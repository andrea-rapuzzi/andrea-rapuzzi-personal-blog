---
import BaseLayout from "../layouts/IndexLayout.astro";
import Post from "../components/Post.astro";

// tipo condivisibile, eventualmente spostabile in un file `types.ts`
type BlogPost = {
  frontmatter: {
    title: string;
    pubDate: string;
    [key: string]: any;
  };
  url: string;
  [key: string]: any;
};

const postImports = import.meta.glob("../pages/posts/*.md", { eager: true });
const allPosts = Object.values(postImports) as BlogPost[];

// ordinamento discendente, una sola conversione della data
allPosts.sort((a, b) => {
  return (
    new Date(b.frontmatter.pubDate).valueOf() -
    new Date(a.frontmatter.pubDate).valueOf()
  );
});

const pageTitle = "Andrea Rapuzzi";
const subTitle = "CX Lead @Nestlé Waters";
---

<BaseLayout pageTitle={pageTitle} subTitle={subTitle}>
  <div class="intro">
    <p>
      Ciao! io sono Andrea e questo è il mio piccolo angolo di
      <strong>internet</strong>. Digital marketer per passione, programmatore
      della domenica, pessimo copywriter. Dal lunedì al venerdì mi occupo di
      CX e dati in Nestlé, mentre nel weekend perdo tempo tra film, progetti
      sgangherati, e qualche buon vinile.
    </p>
    <p class="motto">Nihil difficile volenti</p>
  </div>

  <p>
    <a
      href="https://www.linkedin.com/in/andrea-rapuzzi/"
      target="_blank"
      rel="noopener"
      >→ Qui il mio curriculum vitae</a
    >
  </p>

  <section class="hp-section">
    <div class="line"></div>
    <h3>Blog</h3>

    <ul role="list">
      {allPosts.map((post) => (
        <Post
          url={post.url}
          title={post.frontmatter.title}
          pubDate={post.frontmatter.pubDate}
        />
      ))}
    </ul>

    <p><a href="/blog">→ Tutte le note</a></p>
  </section>

  <!-- library section removed/disabled until serva realmente -->
</BaseLayout>

<style>
  .motto {
    font-style: italic;
    font-size: xx-large;
    font-weight: 100;
  }

  ul {
    padding-left: 0;
    list-style: disc;
  }
</style>
